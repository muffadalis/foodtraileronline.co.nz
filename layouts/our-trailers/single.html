{{ define "main" }}

<div class="mkdf-title-holder mkdf-standard-type mkdf-title-va-window-top mkdf-preload-background mkdf-has-bg-image mkdf-bg-parallax"
    style="height: 650px;background-color: #f5f5f5;background-image:url({{ .Params.banner_image | absURL  }});"
    data-height="650">
    <div class="mkdf-title-image">
        <img src="{{ .Params.banner_image | absURL }}" alt="{{ .Title }}" />
    </div>
    <div class="mkdf-title-wrapper">
        <div class="mkdf-title-inner">
            <div class="mkdf-grid">
                <h6 class="mkdf-page-subtitle">Our Trailers</h6>
                <h1 class="mkdf-page-title" style="color: #ffffff">{{ .Title }}</h1>
            </div>
        </div>
    </div>
</div>

<div class="mkdf-container">
    <div class="mkdf-container-inner">
        <!-- Title Section -->
        <div class="mkdf-section-title-holder">
            <h2 class="mkdf-st-title">{{ .Title }}</h2>
            <span class="mkdf-st-tagline">Our Trailers </span>
            <div class="content-wrapper">
                {{ .Content }}
                {{ range .Params.sizes}}
                    <h5>{{.}}</h5>
                {{ end}}
            </div>
        </div>

        <!-- Specifications Section -->
         
        <div class="mkdf-pricing-tables mkdf-three-columns">
            <div class="mkdf-pt-wrapper">
                {{ with .Params.specs }}
                    {{ range . }}
                    <div class="mkdf-price-table">
                        <div class="mkdf-pt-inner">
                            <ul>
                                <li class="mkdf-pt-title-holder">
                                    <span class="mkdf-pt-title">{{ .category }}</span>
                                </li>
                                <li class="mkdf-pt-content">
                                    <ul>
                                        {{ range .items }}
                                        <li><span class="icon_check"></span>{{ . }}</li>
                                        {{ end}}
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                    {{ end }}
                {{ end}}
            </div>
        </div>

        <!-- Gallery Section -->
        <div class="gallery-grid mkdf-three-columns">
            {{ range .Params.gallery }}
                <div class="gallery-thumb">
                    <img src="{{ . | relURL }}"
                        alt=""
                        width="800"
                        height="600"
                        loading="lazy"
                        class="gallery-open"
                        data-src="{{ . | relURL }}" />
                </div>
            {{ end }}
        </div>

        <!-- Swiper Lightbox -->
        <div class="swiper-lightbox">
            <div class="swiper">
                <div class="swiper-wrapper">
                    {{ range .Params.gallery }}
                        <div class="swiper-slide">
                            <div class="swiper-zoom-container">
                                <img src="{{ . | relURL }}" alt="" />
                            </div>
                        </div>
                    {{ end }}
                </div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
                <div class="swiper-pagination"></div>
                <div class="swiper-lightbox-close">&times;</div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize Swiper
        let lightboxSwiper = new Swiper('.swiper-lightbox .swiper', {
            zoom: true,
            loop: true,
            spaceBetween: 30,
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
                hideOnClick: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            keyboard: {
                enabled: true,
                onlyInViewport: false,
            },
        });

        // Open lightbox
        const galleryThumbs = document.querySelectorAll('.gallery-thumb img');
        const lightbox = document.querySelector('.swiper-lightbox');

        galleryThumbs.forEach((thumb, index) => {
            thumb.addEventListener('click', () => {
                lightbox.style.display = 'block';
                // Reinitialize Swiper when opening lightbox
                lightboxSwiper.destroy(true, true);
                lightboxSwiper = new Swiper('.swiper-lightbox .swiper', {
                    zoom: true,
                    loop: true,
                    spaceBetween: 30,
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                        hideOnClick: false,
                    },
                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true,
                    },
                    keyboard: {
                        enabled: true,
                        onlyInViewport: false,
                    },
                });
                lightboxSwiper.slideTo(index + 1, 0);
            });
        });

        // Close lightbox
        const closeBtn = document.querySelector('.swiper-lightbox-close');
        closeBtn.addEventListener('click', () => {
            lightbox.style.display = 'none';
            lightboxSwiper.destroy(true, true);
        });

        // Close on background click
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                lightbox.style.display = 'none';
                lightboxSwiper.destroy(true, true);
            }
        });

        // Close on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && lightbox.style.display === 'block') {
                lightbox.style.display = 'none';
                lightboxSwiper.destroy(true, true);
            }
        });
    });
</script>

<style>
    /* Gallery Grid */
    .gallery-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 30px;
    }

    .gallery-thumb {
        cursor: pointer;
        overflow: hidden;
    }

    .gallery-thumb img {
        width: 100%;
        height: 300px;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .gallery-thumb:hover img {
        transform: scale(1.05);
    }

    /* Swiper Lightbox */
    .swiper-lightbox {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 9999;
    }

    .swiper-lightbox .swiper {
        width: 100%;
        height: 100%;
    }

    .swiper-lightbox .swiper-slide {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .swiper-zoom-container {
        width: 90%;
        max-width: 1200px;
    }

    .swiper-zoom-container img {
        max-width: 100%;
        height: auto;
    }

    .swiper-lightbox-close {
        position: fixed;
        top: 20px;
        right: 20px;
        color: #fff;
        font-size: 40px;
        cursor: pointer;
        z-index: 10000;
    }

    /* Specifications Section */
.mkdf-pricing-tables {
    margin: 40px 0;
}

.mkdf-pt-wrapper {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    width: 100%;
}

.mkdf-price-table {
    flex: 1 1 calc(33.333% - 15px); /* 3 columns with gap */
    min-width: 280px; /* Minimum width before wrapping */
    background: #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    border-radius: 8px;
}

.mkdf-pt-inner {
    padding: 10px;
    border: 0 !important;
}

.mkdf-pt-title-holder {
    padding: 15px 0;
    border-bottom: 1px solid #eee;
    margin-bottom: 15px;
}

.mkdf-pt-title {
    font-size: 20px;
    font-weight: 600;
    color: #333;
}

.mkdf-pt-content ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.mkdf-pt-content li {
    padding: 8px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.icon_check {
    color: #ed1d24;
}

/* Responsive */
@media (max-width: 768px) {
    .gallery-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .mkdf-pt-wrapper {
        flex-direction: column;
    }
    
    .mkdf-price-table {
        width: 100%;
    }
}

@media (max-width: 1200px) {
    .mkdf-price-table {
        flex: 1 1 calc(33.333% - 20px); /* 3 columns */
    }
}

@media (max-width: 992px) {
    .mkdf-price-table {
        flex: 1 1 calc(50% - 10px); /* 2 columns */
    }
}

@media (max-width: 576px) {
    .mkdf-price-table {
        flex: 1 1 100%; /* 1 column */
    }
}
</style>

{{ end}}